[Unit]
Description=Sidekiq
After=network.target

[Service]
Type=notify
User={{ deploy_user }}

EnvironmentFile={{ app_root_path }}/.rbenv-vars

WorkingDirectory={{ app_current_path }}

ExecStart={{ rbenv_bundle }} exec good_job start

# Greatly reduce Ruby memory fragmentation and heap usage
Environment=MALLOC_ARENA_MAX=2

# if we crash, restart
RestartSec=1
Restart=on-failure

[Install]
WantedBy=multi-user.target
